<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head th:replace="~{fragments/head::head('회원가입')}"></head>
<link rel="stylesheet" th:href="@{/css/signup.css}">
<body class="flex flex-col min-h-screen bg-base-100">

<header th:replace="~{fragments/header}"></header>

<main class="flex-grow pt-10 pb-20">
    <div id="section">
        <h1 class="page-name">회원가입</h1>

        <form action="../member/signup" method="post" th:object="${memberDto}">
            <!-- 아이디 + 중복 확인 버튼 -->
            <div class="userID flex justify-center gap-3">
                <input type="text" th:field="*{userID}" placeholder="아이디" id="userID" required>
                <button type="button" id="btn-id-check">중복확인</button>
            </div>

            <!-- 비밀번호 -->
            <div class="userPW">
                <input type="password" th:field="*{userPW}" placeholder="비밀번호" required>
            </div>

            <!-- 비밀번호 확인 -->
            <div class="userPWConfirm">
                <input type="password" th:field="*{userPWConfirm}" placeholder="비밀번호 확인" required>
            </div>

            <!-- 이름 -->
            <div class="username">
                <input type="text" th:field="*{userName}" placeholder="이름" required>
            </div>

            <!-- 이메일 -->
            <div class="userEmail">
                <input type="text" th:field="*{userEmail}" placeholder="이메일" required>
            </div>

            <!-- 회원가입 버튼 -->
            <div class="join-bt">
                <button type="submit">회원가입</button>
            </div>
        </form>
    </div>
</main>

<footer th:replace="~{fragments/footer::footer-sns}"></footer>

<script>
    const btnIdCheck = document.querySelector("#btn-id-check");
    const userID = document.querySelector("#userID");
    btnIdCheck.addEventListener("click", async () => {
        const res = await fetch("/member/idCheck", {
            method: "post",
            headers: {"Content-Type": "application/json"},
            body: JSON.stringify({ userID: userID.value })
        });
        const data = await res.json();
        alert(data.isDuplicate ? "쓸 수 없는 아이디입니다." : "사용 가능한 아이디입니다!");
    });
</script>
</body>
</html>
